

# import tkinter as tk
# from tkinter import ttk, messagebox, filedialog
# import random
# import time
# import math

# class UniversityScheduler:
#     def __init__(self, root):
#         self.root = root
#         self.root.title("Ù†Ø¸Ø§Ù… Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠØ©")
#         self.root.geometry("1200x750")
#         self.root.resizable(True, True)
#         self.root.configure(bg="#0f172a")
        
#         # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ù…ØªØ­Ø±ÙƒØ© Ù„Ù„Ø®Ù„ÙÙŠØ© Ø£ÙˆÙ„Ø§Ù‹
#         self.canvas = tk.Canvas(self.root, bg="#0f172a", highlightthickness=0)
#         self.canvas.place(x=0, y=0, relwidth=1, relheight=1)
#         self.create_background_animation()
        
#         # Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø¹Ø¯ Ø§Ù„Ø®Ù„ÙÙŠØ©
#         self.style = ttk.Style()
#         self.style.theme_use("clam")
        
#         # ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªØµÙ…ÙŠÙ…
#         self.style.configure("TFrame", background="#0f172a")
#         self.style.configure("Header.TFrame", background="linear-gradient(90deg, #1e3a8a, #0ea5e9)")
#         self.style.configure("Title.TLabel", background="transparent", foreground="white", 
#                             font=("Cairo", 24, "bold"))
#         self.style.configure("Subtitle.TLabel", background="transparent", foreground="#cbd5e1", 
#                             font=("Cairo", 14))
#         self.style.configure("Step.TLabel", background="transparent", foreground="#0ea5e9", 
#                             font=("Cairo", 14, "bold"))
#         self.style.configure("StepNumber.TLabel", background="#0ea5e9", foreground="white", 
#                             font=("Cairo", 14, "bold"), width=3, anchor="center")
#         self.style.configure("Card.TFrame", background="#1e293b", relief="flat", borderwidth=0)
#         self.style.configure("CardTitle.TLabel", background="transparent", foreground="#0ea5e9", 
#                             font=("Cairo", 14, "bold"))
#         self.style.configure("CardIcon.TLabel", background="transparent", foreground="#0ea5e9", 
#                             font=("Cairo", 22))
#         self.style.configure("CardContent.TLabel", background="transparent", foreground="#cbd5e1", 
#                             font=("Cairo", 12), wraplength=250)
#         self.style.configure("Primary.TButton", background="linear-gradient(90deg, #1e3a8a, #0ea5e9)", 
#                             foreground="white", font=("Cairo", 14, "bold"), borderwidth=0, 
#                             relief="flat", padding=10)
#         self.style.map("Primary.TButton", background=[("active", "linear-gradient(90deg, #1e40af, #0284c7)")])
#         self.style.configure("Secondary.TButton", background="#334155", foreground="white", 
#                             font=("Cairo", 14, "bold"), borderwidth=0, relief="flat", padding=10)
#         self.style.map("Secondary.TButton", background=[("active", "#475569")])
#         self.style.configure("Success.TButton", background="linear-gradient(90deg, #047857, #10b981)", 
#                             foreground="white", font=("Cairo", 14, "bold"), borderwidth=0, 
#                             relief="flat", padding=10)
#         self.style.map("Success.TButton", background=[("active", "linear-gradient(90deg, #065f46, #059669)")])
#         self.style.configure("Warning.TButton", background="linear-gradient(90deg, #b45309, #f59e0b)", 
#                             foreground="white", font=("Cairo", 14, "bold"), borderwidth=0, 
#                             relief="flat", padding=10)
#         self.style.map("Warning.TButton", background=[("active", "linear-gradient(90deg, #9a3412, #eab308)")])
#         self.style.configure("SelectedCard.TFrame", background="#334155", relief="flat", borderwidth=0)
#         self.style.configure("PulseSidebarStep.TButton", background="#0ea5e9", foreground="white", 
#                             font=("Cairo", 15, "bold"), borderwidth=0, anchor="w", padding=14)
        
#         # Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
#         self.current_step = 1
#         self.selected_source = None
#         self.algorithm_settings = {
#             "time-conflict": 10,
#             "load-balance": 8,
#             "time-preference": 6,
#             "gap-minimization": 7,
#             "room-capacity": 5,
#             "equipment-match": 9,
#             "room-proximity": 4
#         }
        
#         # Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø©
#         self.status_var = tk.StringVar(value="Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø¯Ø¡")
#         self.status_bar = ttk.Label(root, textvariable=self.status_var, relief="sunken", 
#                                    anchor="center", background="#1e293b", foreground="#0ea5e9",
#                                    font=("Cairo", 11))
#         self.status_bar.pack(side="bottom", fill="x", padx=0, pady=0)

#         # Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
#         self.create_main_layout()
#         self.show_step(1)
    
#     def create_background_animation(self):
#         # Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø³ÙŠÙ…Ø§Øª Ù…ØªØ­Ø±ÙƒØ© Ù„Ù„Ø®Ù„ÙÙŠØ©
#         self.particles = []
#         width = self.root.winfo_width()
#         height = self.root.winfo_height()
        
#         # Ø¥Ù†Ø´Ø§Ø¡ 30 Ø¬Ø³ÙŠÙ…Ø§Ù‹
#         for _ in range(30):
#             x = random.randint(0, width)
#             y = random.randint(0, height)
#             size = random.randint(1, 3)
#             speed = random.uniform(0.5, 2)
#             color = random.choice(["#1e3a8a", "#0ea5e9", "#1e40af", "#0284c7"])
#             particle = self.canvas.create_oval(
#                 x, y, x+size, y+size, 
#                 fill=color, 
#                 outline=""
#             )
#             self.particles.append({
#                 "id": particle,
#                 "x": x,
#                 "y": y,
#                 "size": size,
#                 "speed": speed,
#                 "direction": random.uniform(0, 2 * math.pi)
#             })
        
#         self.animate_particles()
    
#     def animate_particles(self):
#         width = self.root.winfo_width()
#         height = self.root.winfo_height()
        
#         for particle in self.particles:
#             dx = math.cos(particle["direction"]) * particle["speed"]
#             dy = math.sin(particle["direction"]) * particle["speed"]
            
#             new_x = particle["x"] + dx
#             new_y = particle["y"] + dy
            
#             # Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¬Ø³ÙŠÙ… Ø¹Ù†Ø¯ ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ÙˆØ¯
#             if new_x < 0 or new_x > width:
#                 particle["direction"] = math.pi - particle["direction"]
#                 new_x = max(0, min(width, new_x))
            
#             if new_y < 0 or new_y > height:
#                 particle["direction"] = -particle["direction"]
#                 new_y = max(0, min(height, new_y))
            
#             # ØªØ­Ø¯ÙŠØ« Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø¬Ø³ÙŠÙ…
#             self.canvas.move(particle["id"], dx, dy)
#             particle["x"] = new_x
#             particle["y"] = new_y
        
#         self.root.after(30, self.animate_particles)
    
#     def create_main_layout(self):
#         # Ø¥Ø·Ø§Ø± Ø±Ø¦ÙŠØ³ÙŠ Ø£ÙÙ‚ÙŠ: Ø´Ø±ÙŠØ· Ø¬Ø§Ù†Ø¨ÙŠ + Ù…Ø­ØªÙˆÙ‰
#         self.main_frame = ttk.Frame(self.root, style="TFrame")
#         self.main_frame.pack(fill="both", expand=True, padx=15, pady=15)

#         # Ø´Ø±ÙŠØ· Ø¬Ø§Ù†Ø¨ÙŠ Ù„Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·ÙˆØ§Øª
#         self.sidebar = ttk.Frame(self.main_frame, style="TFrame", width=200)
#         self.sidebar.pack(side="left", fill="y", padx=(0, 10), pady=0)
#         self.sidebar.pack_propagate(False)

#         # Ù…Ø­ØªÙˆÙ‰ Ø±Ø¦ÙŠØ³ÙŠ
#         self.content_area = ttk.Frame(self.main_frame, style="TFrame")
#         self.content_area.pack(side="left", fill="both", expand=True)

#         # Ø±Ø£Ø³ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
#         self.create_header(self.content_area)
#         self.create_steps_sidebar()
#         self.create_content_area(self.content_area)

#     def create_header(self, parent):
#         self.header_frame = ttk.Frame(parent, style="Header.TFrame")
#         self.header_frame.pack(fill="x", padx=0, pady=0)
        
#         # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± ØªØ¯Ø±Ø¬ Ù„Ù„Ø±Ø£Ø³
#         header_canvas = tk.Canvas(self.header_frame, bg="#0f172a", highlightthickness=0, height=120)
#         header_canvas.pack(fill="both", expand=True)
        
#         # Ø±Ø³Ù… ØªØ¯Ø±Ø¬ Ù„ÙˆÙ†ÙŠ
#         header_canvas.create_rectangle(0, 0, self.root.winfo_width(), 120, 
#                                       fill="", outline="", 
#                                       tags=("gradient",))
        
#         # ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ¯Ø±Ø¬ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø¬Ù…
#         def update_gradient(event=None):
#             w = header_canvas.winfo_width()
#             for i in range(120):
#                 r = int(14 + (i * (30-14)/120))
#                 g = int(37 + (i * (166-37)/120))
#                 b = int(138 + (i * (234-138)/120))
#                 color = f'#{r:02x}{g:02x}{b:02x}'
#                 header_canvas.create_line(0, i, w, i, fill=color, tags=("gradient",))
#             header_canvas.delete("old_gradient")
#             header_canvas.itemconfig("gradient", tags=("old_gradient",))
        
#         header_canvas.bind("<Configure>", update_gradient)
        
#         # Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ±Ø¹ÙŠ
#         title_frame = ttk.Frame(header_canvas, style="Header.TFrame")
#         title_frame.place(relx=0.5, rely=0.5, anchor="center")
        
#         self.title_label = ttk.Label(
#             title_frame,
#             text="Ù†Ø¸Ø§Ù… Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠØ©",
#             style="Title.TLabel"
#         )
#         self.title_label.pack(pady=5)
        
#         self.subtitle_label = ttk.Label(
#             title_frame,
#             text="Ø§Ù„Ø®Ø·ÙˆØ© 1: ØªØ­Ø¯ÙŠØ¯ Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",
#             style="Subtitle.TLabel"
#         )
#         self.subtitle_label.pack(pady=(0, 10))

#     def create_steps_sidebar(self):
#         # Ø´Ø±ÙŠØ· Ø¬Ø§Ù†Ø¨ÙŠ Ù„Ù„Ø®Ø·ÙˆØ§Øª Ù…Ø¹ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
#         self.sidebar_steps = []
#         step_infos = [
#             ("ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ØµØ¯Ø±", "ğŸ“"),
#             ("Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "ğŸ‘ï¸"),
#             ("Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©", "âš™ï¸"),
#             ("Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ", "ğŸ“…")
#         ]
        
#         # Ø¥Ø·Ø§Ø± Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
#         inner_sidebar = ttk.Frame(self.sidebar, style="Card.TFrame")
#         inner_sidebar.pack(fill="both", expand=True, padx=5, pady=5)
        
#         # Ø¥Ø¶Ø§ÙØ© Ø¸Ù„ Ù„Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
#         self.add_shadow(inner_sidebar, color="#0ea5e9", offset=5)
        
#         for i, (name, icon) in enumerate(step_infos, start=1):
#             btn_frame = ttk.Frame(inner_sidebar, style="TFrame")
#             btn_frame.pack(fill="x", padx=10, pady=8)
            
#             # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„Ø£Ø²Ø±Ø§Ø±
#             btn = ttk.Button(
#                 btn_frame,
#                 text=f"   {icon} {name}",
#                 style="SidebarStep.TButton",
#                 command=lambda s=i: self.show_step(s)
#             )
#             btn.pack(fill="x", padx=0, pady=0)
            
#             # Ø¥Ø¶Ø§ÙØ© Ø¸Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ±
#             btn.bind("<Enter>", lambda e, b=btn: self.glow_button(b, True))
#             btn.bind("<Leave>", lambda e, b=btn: self.glow_button(b, False))
            
#             self.sidebar_steps.append(btn)

#     def create_content_area(self, parent):
#         # Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø¯Ø§Ø®Ù„ Ø¥Ø·Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
#         self.content_frame = ttk.Frame(parent, style="TFrame")
#         self.content_frame.pack(fill="both", expand=True, padx=0, pady=10)
#         self.step_frames = []
#         for i in range(1, 5):
#             frame = ttk.Frame(self.content_frame, style="TFrame")
#             self.step_frames.append(frame)
#             self.create_step_content(i, frame)
    
#     def create_step_content(self, step, frame):
#         if step == 1:
#             self.create_step1(frame)
#         elif step == 2:
#             self.create_step2(frame)
#         elif step == 3:
#             self.create_step3(frame)
#         elif step == 4:
#             self.create_step4(frame)
    
#     def create_step1(self, frame):
#         # Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ© 1: ØªØ­Ø¯ÙŠØ¯ Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
#         instruction = ttk.Label(
#             frame, 
#             text="Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª", 
#             style="Step.TLabel", 
#             font=("Cairo", 15)
#         )
#         instruction.pack(pady=20)
        
#         cards_frame = ttk.Frame(frame, style="TFrame")
#         cards_frame.pack(fill="both", expand=True, padx=10, pady=10)
        
#         # Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø«Ù„Ø§Ø«
#         sources = [
#             {"title": "Ø±ÙØ¹ Ù…Ù„Ù", "icon": "ğŸ“", "desc": "Ø±ÙØ¹ Ù…Ù„Ù Excel Ø£Ùˆ CSV ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª ÙˆØ§Ù„Ù‚Ø§Ø¹Ø§Øª ÙˆØ§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†"},
#             {"title": "Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©", "icon": "ğŸ¯", "desc": "Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¬Ø§Ù‡Ø²Ø© Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø³Ø±Ø¹Ø©"},
#             {"title": "Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ", "icon": "âœï¸", "desc": "Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ§Ø¬Ù‡Ø© Ø³Ù‡Ù„Ø© ÙˆÙ…Ø±Ù†Ø©"}
#         ]
        
#         self.source_cards = []
#         for i, source in enumerate(sources):
#             card_frame = ttk.Frame(cards_frame, style="Card.TFrame", width=300, height=250)
#             card_frame.grid(row=0, column=i, padx=15, pady=15, sticky="nsew")
#             card_frame.grid_propagate(False)
            
#             # Ø¥Ø¶Ø§ÙØ© Ø¸Ù„ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©
#             self.add_shadow(card_frame, color="#0ea5e9", offset=8)
            
#             # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„Ù…Ø±ÙˆØ±
#             card_frame.bind("<Enter>", lambda e, c=card_frame: self.animate_card_hover(c, True))
#             card_frame.bind("<Leave>", lambda e, c=card_frame: self.animate_card_hover(c, False))
            
#             # Ø¥Ø·Ø§Ø± Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©
#             inner_frame = ttk.Frame(card_frame, style="Card.TFrame")
#             inner_frame.pack(fill="both", expand=True, padx=15, pady=15)
            
#             # Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
#             title_frame = ttk.Frame(inner_frame, style="CardTitle.TFrame")
#             title_frame.pack(fill="x", pady=(10, 15))
            
#             icon = ttk.Label(title_frame, text=source["icon"], style="CardIcon.TLabel")
#             icon.pack(side="right", padx=(10, 0))
            
#             title = ttk.Label(title_frame, text=source["title"], style="CardTitle.TLabel")
#             title.pack(side="right", padx=10)
            
#             # Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
#             content = ttk.Label(
#                 inner_frame, 
#                 text=source["desc"], 
#                 style="CardContent.TLabel", 
#                 justify="right"
#             )
#             content.pack(padx=10, pady=10, fill="both", expand=True)
            
#             # Ø²Ø± Ù…Ø¹ Ø£ÙŠÙ‚ÙˆÙ†Ø©
#             btn = ttk.Button(
#                 inner_frame, 
#                 text=f"âœ… Ø§Ø®ØªÙŠØ§Ø±", 
#                 style="Primary.TButton", 
#                 command=lambda s=i: self.select_source(s)
#             )
#             btn.pack(pady=15, padx=20, fill="x")
            
#             # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„Ø²Ø±
#             btn.bind("<Enter>", lambda e, b=btn: self.glow_button(b, True))
#             btn.bind("<Leave>", lambda e, b=btn: self.glow_button(b, False))
            
#             self.source_cards.append(card_frame)

#     def add_shadow(self, widget, color="#0ea5e9", offset=5):
#         # Ø¥Ø¶Ø§ÙØ© Ø¸Ù„ Ù„Ù„Ø¹Ù†ØµØ±
#         shadow = tk.Frame(widget.master, bg=color)
#         shadow.place(in_=widget, x=offset, y=offset, relwidth=1, relheight=1)
#         shadow.lower(widget)
#         return shadow

#     def animate_card_hover(self, card, hover):
#         # ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
#         if hover:
#             card.configure(style="SelectedCard.TFrame")
#             self.glow_card(card, True)
#             self.raise_with_shadow(card)
#         else:
#             card.configure(style="Card.TFrame")
#             self.glow_card(card, False)
#             if self.selected_source != self.source_cards.index(card):
#                 self.lower_with_shadow(card)

#     def raise_with_shadow(self, card):
#         # Ø±ÙØ¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…Ø¹ Ø¸Ù„Ù‡Ø§
#         shadow = card.master.winfo_children()[0]
#         shadow.lift(card)
#         card.lift()

#     def lower_with_shadow(self, card):
#         # Ø®ÙØ¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…Ø¹ Ø¸Ù„Ù‡Ø§
#         shadow = card.master.winfo_children()[0]
#         shadow.lower()
#         card.lower()

#     def glow_card(self, card, enable):
#         # ØªØ£Ø«ÙŠØ± ØªÙˆÙ‡Ø¬ Ø®ÙÙŠÙ Ø­ÙˆÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
#         if enable:
#             for widget in card.winfo_children():
#                 if isinstance(widget, ttk.Frame):
#                     widget.configure(style="SelectedCard.TFrame")
#         else:
#             for widget in card.winfo_children():
#                 if isinstance(widget, ttk.Frame):
#                     widget.configure(style="Card.TFrame")

#     def glow_button(self, button, enable):
#         # ØªØ£Ø«ÙŠØ± ØªÙˆÙ‡Ø¬ Ù„Ù„Ø£Ø²Ø±Ø§Ø±
#         if enable:
#             button.state(['active'])
#         else:
#             button.state(['!active'])

#     def fade_in(self, steps=10, delay=20):
#         """ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ± Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ø´ÙØ§Ù Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"""
#         self.root.attributes("-alpha", 0.0)
#         for i in range(steps):
#             alpha = (i + 1) / steps
#             self.root.update()
#             self.root.attributes("-alpha", alpha)
#             time.sleep(delay/1000)
#         self.root.attributes("-alpha", 1.0)

#     def show_step(self, step):
#         self.current_step = step
#         self.subtitle_label.config(text=f"Ø§Ù„Ø®Ø·ÙˆØ© {step}: {self.get_step_name(step)}")
        
#         # ØªØ­Ø¯ÙŠØ« Ù…Ø¸Ù‡Ø± Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
#         for i, btn in enumerate(self.sidebar_steps, start=1):
#             if i == step:
#                 btn.configure(style="SidebarStepActive.TButton")
#                 self.pulse_button(btn)
#             elif i < step:
#                 btn.configure(style="SidebarStepDone.TButton")
#             else:
#                 btn.configure(style="SidebarStep.TButton")
        
#         # Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
#         for frame in self.step_frames:
#             frame.pack_forget()
        
#         self.step_frames[step-1].pack(fill="both", expand=True)
#         self.status_var.set(f"Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: {self.get_step_name(step)}")
        
#         # Ø­Ø±ÙƒØ© Fade Ù„Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
#         self.fade_in()
        
#         # Ø­Ø±ÙƒØ© Ø§Ù‡ØªØ²Ø§Ø² Ø®ÙÙŠÙØ© Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„
#         if step == 1:
#             for card in self.source_cards:
#                 self.shake_card(card)

#     def pulse_button(self, btn, pulses=8, delay=60):
#         # ØªØ£Ø«ÙŠØ± Ù†Ø¨Ø¶ Ø¹Ø¨Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù€ style ÙÙ‚Ø·
#         def pulse(i=0):
#             if i < pulses:
#                 if i % 2 == 0:
#                     btn.configure(style="PulseSidebarStep.TButton")
#                 else:
#                     btn.configure(style="SidebarStepActive.TButton")
#                 btn.after(delay, lambda: pulse(i+1))
#             else:
#                 btn.configure(style="SidebarStepActive.TButton")
#         pulse()
    
#     def create_step2(self, frame):
#         # Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ© 2: Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
#         instruction = ttk.Label(
#             frame, 
#             text="Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­ØªÙ‡Ø§", 
#             style="Step.TLabel", 
#             font=("Cairo", 15)
#         )
#         instruction.pack(pady=20)
        
#         # Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©
#         stats_frame = ttk.Frame(frame, style="TFrame")
#         stats_frame.pack(fill="x", padx=10, pady=10)
        
#         stats_data = [
#             {"value": "24", "label": "Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©", "icon": "ğŸ“š"},
#             {"value": "12", "label": "Ø£Ø¹Ø¶Ø§Ø¡ Ù‡ÙŠØ¦Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ³", "icon": "ğŸ‘¨â€ğŸ«"},
#             {"value": "8", "label": "Ø§Ù„Ù‚Ø§Ø¹Ø§Øª", "icon": "ğŸ¢"},
#             {"value": "156", "label": "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª", "icon": "â°"}
#         ]
        
#         for i, stat in enumerate(stats_data):
#             card = ttk.Frame(stats_frame, style="Card.TFrame", width=150, height=120)
#             card.grid(row=0, column=i, padx=10, pady=10, sticky="nsew")
#             stats_frame.columnconfigure(i, weight=1)
            
#             # Ø¥Ø¶Ø§ÙØ© Ø¸Ù„ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©
#             self.add_shadow(card, color="#0ea5e9", offset=5)
            
#             inner_frame = ttk.Frame(card, style="Card.TFrame")
#             inner_frame.pack(fill="both", expand=True, padx=10, pady=10)
            
#         icon = ttk.Label(inner_frame, text=stat["icon"], font=("Arial", 24))
#         icon.pack(pady=(5, 5))
        
#         value = ttk.Label(inner_frame, text=stat["value"], font=("Cairo", 18, "bold"), 
#                          foreground="#0ea5e9")
#         value.pack()
        
#         label = ttk.Label(inner_frame, text=stat["label"], style="CardContent.TLabel")
#         label.pack(pady=(0, 5))
        
#         # Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
#         table_frame = ttk.Frame(frame, style="Card.TFrame")
#         table_frame.pack(fill="both", expand=True, padx=10, pady=10)
        
#         # Ø¥Ø¶Ø§ÙØ© Ø¸Ù„ Ù„Ù„Ø¥Ø·Ø§Ø±
#         self.add_shadow(table_frame, color="#0ea5e9", offset=5)
        
#         inner_table_frame = ttk.Frame(table_frame, style="Card.TFrame")
#         inner_table_frame.pack(fill="both", expand=True, padx=10, pady=10)
        
#         # Ø¥Ù†Ø´Ø§Ø¡ Treeview Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
#         self.tree = ttk.Treeview(inner_table_frame, columns=("name", "code", "hours", "teacher"), show="headings")
        
#         # ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ù†Ù…Ø§Ø·
#         self.tree.tag_configure("error", background="#4c1d28")
#         self.tree.tag_configure("warning", background="#473c1b")
        
#         # ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
#         self.tree.heading("name", text="Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©", anchor="center")
#         self.tree.heading("code", text="Ø§Ù„ÙƒÙˆØ¯", anchor="center")
#         self.tree.heading("hours", text="Ø§Ù„Ø³Ø§Ø¹Ø§Øª", anchor="center")
#         self.tree.heading("teacher", text="Ø§Ù„Ù…Ø¯Ø±Ø³", anchor="center")
        
#         self.tree.column("name", width=150, anchor="e")
#         self.tree.column("code", width=80, anchor="center")
#         self.tree.column("hours", width=80, anchor="center")
#         self.tree.column("teacher", width=150, anchor="e")
        
#         # Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙŠØ· ØªÙ…Ø±ÙŠØ±
#         scrollbar = ttk.Scrollbar(inner_table_frame, orient="vertical", command=self.tree.yview)
#         self.tree.configure(yscrollcommand=scrollbar.set)
#         scrollbar.pack(side="right", fill="y")
#         self.tree.pack(side="left", fill="both", expand=True)
        
#         # Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
#         courses = [
#             ("Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨", "CS101", "3", "Ø¯. Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯", ""),
#             ("Ù‡ÙŠØ§ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "CS102", "4", "Ø¯. ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ", ""),
#             ("Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "CS103", "3", "Ø¯. Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", ""),
#             ("Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©", "MATH201", "4", "", "error"),
#             ("Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø­Ø§Ø³ÙˆØ¨", "NET201", "3", "Ø¯. Ø®Ø§Ù„Ø¯ Ø¹Ù„ÙŠ", ""),
#             ("Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª", "SEC301", "2", "Ø¯. ÙŠØ§Ø³Ø± Ù…Ø­Ù…ÙˆØ¯", "warning"),
#             ("Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ", "CS301", "3", "Ø¯. Ø³Ø§Ø±Ø© Ø­Ø³Ù†", ""),
#             ("Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª", "CS302", "3", "Ø¯. Ø¹Ù…Ø± ÙƒÙ…Ø§Ù„", ""),
#             ("Ù†Ø¸Ù… Ø§Ù„ØªØ´ØºÙŠÙ„", "CS303", "4", "Ø¯. Ù„ÙŠÙ„Ù‰ Ø£Ø­Ù…Ø¯", ""),
#             ("Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø¯ÙŠ", "MATH202", "3", "Ø¯. Ø®Ø§Ù„Ø¯ Ù…Ø­Ù…ÙˆØ¯", ""),
#             ("Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ù†Ø·Ù‚ÙŠ", "EE201", "3", "Ø¯. Ù†Ø§Ø¯Ø± Ø³Ù„ÙŠÙ…", ""),
#             ("Ø§Ù„Ø§Ø­ØµØ§Ø¡ ÙˆØ§Ù„Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª", "MATH101", "3", "Ø¯. Ù…Ù†Ù‰ ØµØ¨Ø­ÙŠ", ""),
#             ("Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨", "CS401", "3", "Ø¯. Ø¨Ø§Ø³Ù… ÙˆÙ„ÙŠØ¯", ""),
#             ("Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹", "MGT301", "2", "Ø¯. Ù‡Ø¨Ø© Ù…Ø­Ù…Ø¯", "")
#         ]
        
#         for course in courses:
#             tags = (course[4],) if course[4] else ()
#             self.tree.insert("", "end", values=course[:4], tags=tags)
        
#         # Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
#         btn_frame = ttk.Frame(frame, style="TFrame")
#         btn_frame.pack(fill="x", padx=10, pady=15)
        
#         ttk.Button(
#             btn_frame, 
#             text="Ø§Ù„Ø¹ÙˆØ¯Ø©", 
#             style="Secondary.TButton", 
#             command=lambda: self.show_step(1)
#         ).pack(side="right", padx=10)
        
#         ttk.Button(
#             btn_frame, 
#             text="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", 
#             style="Warning.TButton", 
#             command=self.edit_data
#         ).pack(side="right", padx=10)
        
#         ttk.Button(
#             btn_frame, 
#             text="Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©", 
#             style="Primary.TButton", 
#             command=lambda: self.show_step(3)
#         ).pack(side="right", padx=10)
        
#         # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„Ø£Ø²Ø±Ø§Ø±
#         for btn in btn_frame.winfo_children():
#             btn.bind("<Enter>", lambda e, b=btn: self.glow_button(b, True))
#             btn.bind("<Leave>", lambda e, b=btn: self.glow_button(b, False))
    
#     def create_step3(self, frame):
#         # Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©
#         instruction = ttk.Label(
#             frame, 
#             text="Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„", 
#             style="Step.TLabel", 
#             font=("Cairo", 15)
#         )
#         instruction.pack(pady=20)
        
#         main_frame = ttk.Frame(frame, style="TFrame")
#         main_frame.pack(fill="both", expand=True, padx=10, pady=10)
        
#         # Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø¨Ù‚Ø©
#         preset_frame = ttk.Frame(main_frame, style="Card.TFrame")
#         preset_frame.pack(fill="x", padx=5, pady=5)
        
#         # Ø¥Ø¶Ø§ÙØ© Ø¸Ù„ Ù„Ù„Ø¥Ø·Ø§Ø±
#         self.add_shadow(preset_frame, color="#0ea5e9", offset=5)
        
#         inner_preset_frame = ttk.Frame(preset_frame, style="Card.TFrame")
#         inner_preset_frame.pack(fill="x", padx=15, pady=10)
        
#         ttk.Label(
#             inner_preset_frame, 
#             text="Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø¨Ù‚Ø© Ù„Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ©:", 
#             style="CardContent.TLabel", 
#             font=("Cairo", 12, "bold")
#         ).pack(side="right", padx=10, pady=5)
        
#         presets = [
#             ("Ù…ØªÙˆØ§Ø²Ù†", "âš–ï¸"),
#             ("Ø§Ù„ÙƒÙØ§Ø¡Ø©", "âš¡"),
#             ("Ø§Ù„Ù…Ø±ÙˆÙ†Ø©", "ğŸ”„"),
#             ("Ù…Ø®ØµØµ", "âš™ï¸")
#         ]
        
#         for preset, icon in presets:
#             btn = ttk.Button(
#                 inner_preset_frame, 
#                 text=f"{icon} {preset}", 
#                 style="Secondary.TButton", 
#                 width=10,
#                 command=lambda p=preset: self.load_preset(p)
#             )
#             btn.pack(side="right", padx=5, pady=5)
            
#             # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„Ø²Ø±
#             btn.bind("<Enter>", lambda e, b=btn: self.glow_button(b, True))
#             btn.bind("<Leave>", lambda e, b=btn: self.glow_button(b, False))
        
#         # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ©
#         settings_frame = ttk.Frame(main_frame, style="Card.TFrame")
#         settings_frame.pack(fill="both", expand=True, padx=5, pady=5)
        
#         # Ø¥Ø¶Ø§ÙØ© Ø¸Ù„ Ù„Ù„Ø¥Ø·Ø§Ø±
#         self.add_shadow(settings_frame, color="#0ea5e9", offset=5)
        
#         inner_settings_frame = ttk.Frame(settings_frame, style="Card.TFrame")
#         inner_settings_frame.pack(fill="both", expand=True, padx=15, pady=15)
        
#         # Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø·Ø§Ø±Ø§Øª Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
#         col1 = ttk.Frame(inner_settings_frame, style="TFrame")
#         col1.pack(side="left", fill="both", expand=True, padx=10, pady=10)
        
#         col2 = ttk.Frame(inner_settings_frame, style="TFrame")
#         col2.pack(side="left", fill="both", expand=True, padx=10, pady=10)
        
#         # Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
#         settings = [
#             ("ØªØ¬Ù†Ø¨ ØªØ¶Ø§Ø±Ø¨ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª", "time-conflict", "Ù…Ù†Ø¹ ØªØ¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ù„Ù†ÙØ³ Ø§Ù„Ù…Ø¯Ø±Ø³ Ø£Ùˆ Ø§Ù„Ù‚Ø§Ø¹Ø©"),
#             ("ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ø­Ù…Ø§Ù„", "load-balance", "ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø¨Ø§Ù„ØªØ³Ø§ÙˆÙŠ Ø¹Ù„Ù‰ Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"),
#             ("ØªÙØ¶ÙŠÙ„Ø§Øª Ø§Ù„Ø£ÙˆÙ‚Ø§Øª", "time-preference", "Ù…Ø±Ø§Ø¹Ø§Ø© Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ÙØ¶Ù„Ø© Ù„Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†"),
#             ("ØªØ¬Ù†Ø¨ Ø§Ù„ÙØ¬ÙˆØ§Øª Ø§Ù„Ø·ÙˆÙŠÙ„Ø©", "gap-minimization", "ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª"),
#             ("Ù…Ù„Ø§Ø¡Ù…Ø© Ø§Ù„Ù‚Ø§Ø¹Ø§Øª", "room-capacity", "Ù…Ø·Ø§Ø¨Ù‚Ø© Ø­Ø¬Ù… Ø§Ù„Ù‚Ø§Ø¹Ø© Ù…Ø¹ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨"),
#             ("Ø§Ù„Ù…Ø¹Ø¯Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©", "equipment-match", "ØªÙˆÙØ± Ø§Ù„Ù…Ø¹Ø¯Ø§Øª Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª"),
#             ("Ù‚Ø±Ø¨ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª", "room-proximity", "ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„Ù…ØªØªØ§Ù„ÙŠØ©")
#         ]
        
#         for i, (name, key, desc) in enumerate(settings):
#             parent = col1 if i < 4 else col2
#             self.create_setting_slider(parent, name, key, desc)
        
#         # Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
#         btn_frame = ttk.Frame(main_frame, style="TFrame")
#         btn_frame.pack(fill="x", padx=5, pady=15)
        
#         ttk.Button(
#             btn_frame, 
#             text="Ø§Ù„Ø¹ÙˆØ¯Ø©", 
#             style="Secondary.TButton", 
#             command=lambda: self.show_step(2)
#         ).pack(side="right", padx=10)
        
#         ttk.Button(
#             btn_frame, 
#             text="Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„", 
#             style="Primary.TButton", 
#             command=self.generate_schedule
#         ).pack(side="right", padx=10)
        
#         ttk.Button(
#             btn_frame, 
#             text="Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", 
#             style="Success.TButton", 
#             command=self.save_settings
#         ).pack(side="right", padx=10)
        
#         # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„Ø£Ø²Ø±Ø§Ø±
#         for btn in btn_frame.winfo_children():
#             btn.bind("<Enter>", lambda e, b=btn: self.glow_button(b, True))
#             btn.bind("<Leave>", lambda e, b=btn: self.glow_button(b, False))
    
#     def create_setting_slider(self, parent, name, key, desc):
#         frame = ttk.Frame(parent, style="TFrame")
#         frame.pack(fill="x", pady=10)
        
#         ttk.Label(
#             frame, 
#             text=name, 
#             style="CardContent.TLabel", 
#             font=("Cairo", 11, "bold")
#         ).pack(anchor="w")
        
#         ttk.Label(
#             frame, 
#             text=desc, 
#             style="CardContent.TLabel", 
#             font=("Cairo", 10)
#         ).pack(anchor="w")
        
#         slider_frame = ttk.Frame(frame, style="TFrame")
#         slider_frame.pack(fill="x", pady=10)
        
#         self.algorithm_settings[key] = tk.IntVar(value=self.algorithm_settings[key])
        
#         value_label = ttk.Label(
#             slider_frame, 
#             textvariable=self.algorithm_settings[key], 
#             width=2,
#             style="CardContent.TLabel", 
#             font=("Cairo", 11, "bold")
#         )
#         value_label.pack(side="right", padx=(10, 0))
        
#         slider = ttk.Scale(
#             slider_frame, 
#             from_=0, 
#             to=10, 
#             variable=self.algorithm_settings[key],
#             command=lambda v, k=key: self.update_setting(k, v),
#             length=200
#         )
#         slider.pack(side="right", padx=5, fill="x", expand=True)
        
#         # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ù„Ù„Ù…Ø¤Ø´Ø±
#         slider.bind("<Enter>", lambda e: slider.configure(style="Hover.TScale"))
#         slider.bind("<Leave>", lambda e: slider.configure(style="TScale"))
    
#     def create_step4(self, frame):
#         # Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ© 4: Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
#         instruction = ttk.Label(
#             frame, 
#             text="Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ", 
#             style="Step.TLabel", 
#             font=("Cairo", 15)
#         )
#         instruction.pack(pady=20)
        
#         # Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©
#         stats_frame = ttk.Frame(frame, style="TFrame")
#         stats_frame.pack(fill="x", padx=10, pady=10)
        
#         stats_data = [
#             {"value": "95%", "label": "Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª", "icon": "ğŸ“Š", "color": "#0ea5e9"},
#             {"value": "0", "label": "Ø§Ù„ØªØ¶Ø§Ø±Ø¨Ø§Øª Ø§Ù„Ø²Ù…Ù†ÙŠØ©", "icon": "âš ï¸", "color": "#10b981"},
#             {"value": "8.2", "label": "Ù…ØªÙˆØ³Ø· Ø§Ù„Ø­Ù…Ù„ Ø§Ù„ØªØ¯Ø±ÙŠØ³ÙŠ", "icon": "âš–ï¸", "color": "#f59e0b"},
#             {"value": "12", "label": "Ø§Ù„ÙØ¬ÙˆØ§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©", "icon": "â³", "color": "#ef4444"}
#         ]
        
#         for i, stat in enumerate(stats_data):
#             card = ttk.Frame(stats_frame, style="Card.TFrame", width=150, height=120)
#             card.grid(row=0, column=i, padx=10, pady=10, sticky="nsew")
#             stats_frame.columnconfigure(i, weight=1)
            
#             # Ø¥Ø¶Ø§ÙØ© Ø¸Ù„ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©
#             self.add_shadow(card, color=stat["color"], offset=5)
            
#             inner_frame = ttk.Frame(card, style="Card.TFrame")
#             inner_frame.pack(fill="both", expand=True, padx=10, pady=10)
            
#             icon = ttk.Label(inner_frame, text=stat["icon"], font=("Arial", 24), 
#                             foreground=stat["color"])
#             icon.pack(pady=(5, 5))
            
#             value = ttk.Label(inner_frame, text=stat["value"], font=("Cairo", 18, "bold"), 
#                              foreground=stat["color"])
#             value.pack()
            
#             label = ttk.Label(inner_frame, text=stat["label"], style="CardContent.TLabel")
#             label.pack(pady=(0, 5))
        
#         # Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ
#         table_frame = ttk.Frame(frame, style="Card.TFrame")
#         table_frame.pack(fill="both", expand=True, padx=10, pady=10)
        
#         # Ø¥Ø¶Ø§ÙØ© Ø¸Ù„ Ù„Ù„Ø¥Ø·Ø§Ø±
#         self.add_shadow(table_frame, color="#0ea5e9", offset=5)
        
#         inner_table_frame = ttk.Frame(table_frame, style="Card.TFrame")
#         inner_table_frame.pack(fill="both", expand=True, padx=10, pady=10)
        
#         # Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ
#         self.schedule_tree = ttk.Treeview(
#             inner_table_frame, 
#             columns=("time", "sun", "mon", "tue", "wed", "thu"), 
#             show="headings",
#             height=6
#         )
        
#         # ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
#         self.schedule_tree.heading("time", text="Ø§Ù„ÙˆÙ‚Øª", anchor="center")
#         self.schedule_tree.heading("sun", text="Ø§Ù„Ø£Ø­Ø¯", anchor="center")
#         self.schedule_tree.heading("mon", text="Ø§Ù„Ø§Ø«Ù†ÙŠÙ†", anchor="center")
#         self.schedule_tree.heading("tue", text="Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", anchor="center")
#         self.schedule_tree.heading("wed", text="Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", anchor="center")
#         self.schedule_tree.heading("thu", text="Ø§Ù„Ø®Ù…ÙŠØ³", anchor="center")
        
#         self.schedule_tree.column("time", width=100, anchor="center")
#         self.schedule_tree.column("sun", width=180, anchor="center")
#         self.schedule_tree.column("mon", width=180, anchor="center")
#         self.schedule_tree.column("tue", width=180, anchor="center")
#         self.schedule_tree.column("wed", width=180, anchor="center")
#         self.schedule_tree.column("thu", width=180, anchor="center")
        
#         # Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙŠØ· ØªÙ…Ø±ÙŠØ±
#         scrollbar = ttk.Scrollbar(inner_table_frame, orient="vertical", command=self.schedule_tree.yview)
#         self.schedule_tree.configure(yscrollcommand=scrollbar.set)
#         scrollbar.pack(side="right", fill="y")
#         self.schedule_tree.pack(side="left", fill="both", expand=True)
        
#         # Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
#         schedule = [
#             ("8:00 - 9:30", "Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨", "Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "Ù‡ÙŠØ§ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨", "Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª"),
#             ("10:00 - 11:30", "Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø­Ø§Ø³ÙˆØ¨", "Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª", "Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ", "Ù‡ÙŠØ§ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"),
#             ("12:00 - 1:30", "", "Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª", "Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø¯ÙŠ", "Ù†Ø¸Ù… Ø§Ù„ØªØ´ØºÙŠÙ„", ""),
#             ("2:00 - 3:30", "ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹", "Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ù†Ø·Ù‚ÙŠ", "Ø§Ù„Ø§Ø­ØµØ§Ø¡ ÙˆØ§Ù„Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª", "Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨", "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹"),
#             ("4:00 - 5:30", "Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ", "Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø­Ø§Ø³ÙˆØ¨", "Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª", "Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ù†Ø·Ù‚ÙŠ", "Ù†Ø¸Ù… Ø§Ù„ØªØ´ØºÙŠÙ„")
#         ]
        
#         for row in schedule:
#             self.schedule_tree.insert("", "end", values=row)
        
#         # Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
#         btn_frame = ttk.Frame(frame, style="TFrame")
#         btn_frame.pack(fill="x", padx=10, pady=15)
        
#         ttk.Button(
#             btn_frame, 
#             text="Ø§Ù„Ø¹ÙˆØ¯Ø©", 
#             style="Secondary.TButton", 
#             command=lambda: self.show_step(3)
#         ).pack(side="right", padx=10)
        
#         ttk.Button(
#             btn_frame, 
#             text="ØªØµØ¯ÙŠØ± Ø§Ù„Ø¬Ø¯ÙˆÙ„", 
#             style="Warning.TButton", 
#             command=self.export_schedule
#         ).pack(side="right", padx=10)
        
#         ttk.Button(
#             btn_frame, 
#             text="ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙˆÙ„", 
#             style="Success.TButton", 
#             command=self.save_schedule
#         ).pack(side="right", padx=10)
        
#         # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„Ø£Ø²Ø±Ø§Ø±
#         for btn in btn_frame.winfo_children():
#             btn.bind("<Enter>", lambda e, b=btn: self.glow_button(b, True))
#             btn.bind("<Leave>", lambda e, b=btn: self.glow_button(b, False))
    
#     def select_source(self, source_index):
#         self.selected_source = source_index
#         sources = ["Ø±ÙØ¹ Ù…Ù„Ù", "Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©", "Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ"]
        
#         # ØªØ­Ø¯ÙŠØ« Ù…Ø¸Ù‡Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
#         for i, card in enumerate(self.source_cards):
#             if i == source_index:
#                 card.configure(style="SelectedCard.TFrame")
#                 self.raise_with_shadow(card)
#                 self.glow_card(card, True)
#             else:
#                 card.configure(style="Card.TFrame")
#                 self.lower_with_shadow(card)
#                 self.glow_card(card, False)
        
#         # Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
#         self.show_step(2)
        
#         # ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø©
#         self.status_var.set(f"ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: {sources[source_index]}")
    
#     def edit_data(self):
#         messagebox.showinfo("ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "Ø³ÙŠØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª")
#         self.status_var.set("Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ù…Ø­Ø±Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...")
    
#     def update_setting(self, key, value):
#         # ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±
#         try:
#             self.algorithm_settings[key] = int(float(value))
#         except ValueError:
#             pass
    
#     def load_preset(self, preset):
#         messagebox.showinfo("ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", f"ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø¨Ù‚Ø©: {preset}")
#         self.status_var.set(f"ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª: {preset}")
    
#     def save_settings(self):
#         messagebox.showinfo("Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", "ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­")
#         self.status_var.set("ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ©")
    
#     def generate_schedule(self):
#         # Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„
#         self.status_var.set("Ø¬Ø§Ø±Ù Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ...")
#         progress = tk.Toplevel(self.root)
#         progress.title("Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„")
#         progress.geometry("500x300")
#         progress.resizable(False, False)
#         progress.configure(bg="#0f172a")
#         progress.attributes("-alpha", 0.95)  # Ø´ÙØ§ÙÙŠØ© Ø®ÙÙŠÙØ©
        
#         # ØªØ®ØµÙŠØµ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù†Ø§ÙØ°Ø©
#         ttk.Style(progress).configure("TFrame", background="#0f172a")
#         ttk.Style(progress).configure("TLabel", background="#0f172a", foreground="#cbd5e1", font=("Cairo", 12))
#         ttk.Style(progress).configure("TProgressbar", background="#0ea5e9", troughcolor="#1e293b")
        
#         # Ø¥Ø·Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø©
#         main_frame = ttk.Frame(progress, style="TFrame")
#         main_frame.pack(fill="both", expand=True, padx=20, pady=20)
        
#         # Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ø§ÙØ°Ø©
#         title = ttk.Label(main_frame, text="Ø¬Ø§Ø±Ù Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ", 
#                          font=("Cairo", 16, "bold"), foreground="#0ea5e9")
#         title.pack(pady=(10, 20))
        
#         # Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
#         canvas = tk.Canvas(main_frame, width=150, height=150, bg="#0f172a", highlightthickness=0)
#         canvas.pack(pady=10)
        
#         # Ø±Ø³Ù… Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
#         progress_circle = canvas.create_arc(10, 10, 140, 140, start=90, extent=0, 
#                                           style="arc", width=8, outline="#0ea5e9")
        
#         # Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙ‚Ø¯Ù…
#         steps = [
#             "Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...",
#             "ØªØ·Ø¨ÙŠÙ‚ Ù‚ÙŠÙˆØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©...",
#             "ØªØ­Ø³ÙŠÙ† ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª...",
#             "ÙØ­Øµ Ø§Ù„ØªØ¶Ø§Ø±Ø¨Ø§Øª...",
#             "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ..."
#         ]
        
#         step_var = tk.StringVar(value=steps[0])
#         step_label = ttk.Label(main_frame, textvariable=step_var, wraplength=400)
#         step_label.pack(pady=10)
        
#         # Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
#         def simulate_progress():
#             for i, step in enumerate(steps):
#                 step_var.set(step)
                
#                 # ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
#                 extent = (i + 1) * (360 / len(steps))
#                 canvas.itemconfig(progress_circle, extent=-extent)
                
#                 # ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ù„ÙˆØ§Ù†
#                 r = int(14 + (i * (234-14)/len(steps)))
#                 g = int(37 + (i * (166-37)/len(steps)))
#                 b = int(138 + (i * (234-138)/len(steps)))
#                 color = f'#{r:02x}{g:02x}{b:02x}'
#                 canvas.itemconfig(progress_circle, outline=color)
                
#                 progress.update()
#                 time.sleep(0.8)
            
#             progress.destroy()
#             self.show_step(4)
#             self.status_var.set("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­")
#             messagebox.showinfo("ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡", "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø¨Ù†Ø¬Ø§Ø­")
        
#         progress.after(100, simulate_progress)
    
#     def export_schedule(self):
#         file_path = filedialog.asksaveasfilename(
#             defaultextension=".xlsx",
#             filetypes=[("Excel files", "*.xlsx"), ("PDF files", "*.pdf"), ("All files", "*.*")]
#         )
#         if file_path:
#             self.status_var.set(f"ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¥Ù„Ù‰: {file_path}")
#             messagebox.showinfo("Ø§Ù„ØªØµØ¯ÙŠØ±", f"ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ Ø¥Ù„Ù‰:\n{file_path}")
    
#     def save_schedule(self):
#         self.status_var.set("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ")
#         messagebox.showinfo("Ø§Ù„Ø­ÙØ¸", "ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø¨Ù†Ø¬Ø§Ø­")
    
#     def shake_card(self, card, shakes=8, distance=8, delay=20):
#         # ØªØ£Ø«ÙŠØ± Ø§Ù‡ØªØ²Ø§Ø² Ø®ÙÙŠÙ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©
#         orig_x = card.winfo_x()
#         orig_y = card.winfo_y()
        
#         def shake(i=0):
#             if i < shakes:
#                 # Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø§Ù‡ØªØ²Ø§Ø² (Ø£Ø¹Ù„Ù‰ØŒ ÙŠÙ…ÙŠÙ†ØŒ Ø£Ø³ÙÙ„ØŒ ÙŠØ³Ø§Ø±)
#                 directions = [(0, -distance), (distance, 0), (0, distance), (-distance, 0)]
#                 dx, dy = directions[i % 4]
                
#                 card.place_configure(x=orig_x + dx, y=orig_y + dy)
#                 card.after(delay, lambda: shake(i+1))
#             else:
#                 card.place_configure(x=orig_x, y=orig_y)
        
#         shake()
    
#     def get_step_name(self, step):
#         names = {
#             1: "ØªØ­Ø¯ÙŠØ¯ Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",
#             2: "Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",
#             3: "Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©",
#             4: "Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ"
#         }
#         return names.get(step, "")

#     def set_status(self, msg, status_type="info"):
#         self.status_var.set(msg)
#         color = {
#             "info": "#0ea5e9",
#             "success": "#10b981",
#             "warning": "#f59e0b",
#             "error": "#ef4444"
#         }.get(status_type, "#0ea5e9")
#         self.status_bar.configure(foreground=color)

# if __name__ == "__main__":
#     root = tk.Tk()
    
#     # Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…Ø§Ø· Ø¥Ø¶Ø§ÙÙŠØ©
#     style = ttk.Style()
    
#     # ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ù†Ù…Ø§Ø·
#     style.configure("TFrame", background="#0f172a")
#     style.configure("Header.TFrame", background="linear-gradient(90deg, #1e3a8a, #0ea5e9)")
#     style.configure("Title.TLabel", background="transparent", foreground="white", 
#                   font=("Cairo", 24, "bold"))
#     style.configure("Subtitle.TLabel", background="transparent", foreground="#cbd5e1", 
#                   font=("Cairo", 14))
#     style.configure("Step.TLabel", background="transparent", foreground="#0ea5e9", 
#                   font=("Cairo", 14, "bold"))
#     style.configure("Card.TFrame", background="#1e293b", relief="flat", borderwidth=0)
#     style.configure("CardTitle.TLabel", background="transparent", foreground="#0ea5e9", 
#                   font=("Cairo", 14, "bold"))
#     style.configure("CardIcon.TLabel", background="transparent", foreground="#0ea5e9", 
#                   font=("Cairo", 22))
#     style.configure("CardContent.TLabel", background="transparent", foreground="#cbd5e1", 
#                   font=("Cairo", 12))
#     style.configure("Primary.TButton", background="linear-gradient(90deg, #1e3a8a, #0ea5e9)", 
#                   foreground="white", font=("Cairo", 14, "bold"), borderwidth=0, 
#                   padding=10)
#     style.map("Primary.TButton", background=[("active", "linear-gradient(90deg, #1e40af, #0284c7)")])
#     style.configure("Secondary.TButton", background="#334155", foreground="white", 
#                   font=("Cairo", 14, "bold"), borderwidth=0, padding=10)
#     style.map("Secondary.TButton", background=[("active", "#475569")])
#     style.configure("Success.TButton", background="linear-gradient(90deg, #047857, #10b981)", 
#                   foreground="white", font=("Cairo", 14, "bold"), borderwidth=0, 
#                   padding=10)
#     style.map("Success.TButton", background=[("active", "linear-gradient(90deg, #065f46, #059669)")])
#     style.configure("Warning.TButton", background="linear-gradient(90deg, #b45309, #f59e0b)", 
#                   foreground="white", font=("Cairo", 14, "bold"), borderwidth=0, 
#                   padding=10)
#     style.map("Warning.TButton", background=[("active", "linear-gradient(90deg, #9a3412, #eab308)")])
#     style.configure("SelectedCard.TFrame", background="#334155", relief="flat", borderwidth=0)
#     style.configure("SidebarStep.TButton", background="#1e293b", foreground="#cbd5e1", 
#                   font=("Cairo", 14, "bold"), borderwidth=0, anchor="w", padding=12)
#     style.map("SidebarStep.TButton", background=[("active", "#334155")], 
#              foreground=[("active", "white")])
#     style.configure("SidebarStepActive.TButton", background="#0ea5e9", foreground="white", 
#                   font=("Cairo", 15, "bold"), borderwidth=0, anchor="w", padding=14)
#     style.configure("SidebarStepDone.TButton", background="#10b981", foreground="white", 
#                   font=("Cairo", 14), borderwidth=0, anchor="w", padding=12)
#     style.configure("PulseSidebarStep.TButton", background="#0284c7", foreground="white", 
#                   font=("Cairo", 15, "bold"), borderwidth=0, anchor="w", padding=14)
#     style.configure("StatusBar.TLabel", background="#1e293b", foreground="#0ea5e9", 
#                   font=("Cairo", 11), relief="sunken")
    
#     app = UniversityScheduler(root)
#     root.mainloop()